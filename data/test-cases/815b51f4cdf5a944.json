{"uid":"815b51f4cdf5a944","name":"test_2fa_email","fullName":"tests.e2e.test_authentication_e2e#test_2fa_email","historyId":"ba1d92cd134a5df5e30139692d947b80","time":{"start":1762332344503,"stop":1762332345145,"duration":642},"status":"broken","statusMessage":"aiosmtplib.errors.SMTPConnectError: Error connecting to mailhog on port 1025: [Errno -3] Temporary failure in name resolution","statusTrace":"self = <aiosmtplib.smtp.SMTP object at 0x7f1d0491a7b0>, timeout = 60\n\n    async def _create_connection(self, timeout: Optional[float]) -> SMTPResponse:\n        if self.loop is None:\n            raise RuntimeError(\"No event loop set\")\n    \n        protocol = SMTPProtocol(loop=self.loop, connection_lost_callback=self.close)\n    \n        tls_context: Optional[ssl.SSLContext] = None\n        ssl_handshake_timeout: Optional[float] = None\n        server_hostname: Optional[str] = None\n        if self.use_tls:\n            tls_context = self._get_tls_context()\n            ssl_handshake_timeout = timeout\n            server_hostname = self.hostname\n    \n        if self.sock is not None:\n            connect_coro = self.loop.create_connection(\n                lambda: protocol,\n                sock=self.sock,\n                ssl=tls_context,\n                server_hostname=server_hostname,\n                ssl_handshake_timeout=ssl_handshake_timeout,\n            )\n        elif self.socket_path is not None:\n            connect_coro = self.loop.create_unix_connection(\n                lambda: protocol,\n                path=self.socket_path,  # type: ignore\n                ssl=tls_context,\n                server_hostname=server_hostname,\n                ssl_handshake_timeout=ssl_handshake_timeout,\n            )\n        else:\n            if self.hostname is None:\n                raise RuntimeError(\"No hostname provided; default should have been set\")\n            if self.port is None:\n                raise RuntimeError(\"No port provided; default should have been set\")\n    \n            connect_coro = self.loop.create_connection(\n                lambda: protocol,\n                host=self.hostname,\n                port=self.port,\n                ssl=tls_context,\n                ssl_handshake_timeout=ssl_handshake_timeout,\n                local_addr=self.source_address,\n            )\n    \n        try:\n>           transport, _ = await asyncio.wait_for(connect_coro, timeout=timeout)\n                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\n../../../.cache/pypoetry/virtualenvs/ppo-_4RQizgT-py3.13/lib/python3.13/site-packages/aiosmtplib/smtp.py:503: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/opt/hostedtoolcache/Python/3.13.9/x64/lib/python3.13/asyncio/tasks.py:507: in wait_for\n    return await fut\n           ^^^^^^^^^\n/opt/hostedtoolcache/Python/3.13.9/x64/lib/python3.13/asyncio/base_events.py:1122: in create_connection\n    infos = await self._ensure_resolved(\n/opt/hostedtoolcache/Python/3.13.9/x64/lib/python3.13/asyncio/base_events.py:1508: in _ensure_resolved\n    return await loop.getaddrinfo(host, port, family=family, type=type,\n/opt/hostedtoolcache/Python/3.13.9/x64/lib/python3.13/asyncio/base_events.py:939: in getaddrinfo\n    return await self.run_in_executor(\n/opt/hostedtoolcache/Python/3.13.9/x64/lib/python3.13/concurrent/futures/thread.py:59: in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nhost = 'mailhog', port = 1025, family = 0, type = <SocketKind.SOCK_STREAM: 1>\nproto = 0, flags = 0\n\n    def getaddrinfo(host, port, family=0, type=0, proto=0, flags=0):\n        \"\"\"Resolve host and port into list of address info entries.\n    \n        Translate the host/port argument into a sequence of 5-tuples that contain\n        all the necessary arguments for creating a socket connected to that service.\n        host is a domain name, a string representation of an IPv4/v6 address or\n        None. port is a string service name such as 'http', a numeric port number or\n        None. By passing None as the value of host and port, you can pass NULL to\n        the underlying C API.\n    \n        The family, type and proto arguments can be optionally specified in order to\n        narrow the list of addresses returned. Passing zero as a value for each of\n        these arguments selects the full range of results.\n        \"\"\"\n        # We override this function since we want to translate the numeric family\n        # and socket type values to enum constants.\n        addrlist = []\n>       for res in _socket.getaddrinfo(host, port, family, type, proto, flags):\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nE       socket.gaierror: [Errno -3] Temporary failure in name resolution\n\n/opt/hostedtoolcache/Python/3.13.9/x64/lib/python3.13/socket.py:977: gaierror\n\nThe above exception was the direct cause of the following exception:\n\n    @pytest.mark.order(1)\n    @pytest.mark.asyncio\n    async def test_2fa_email():\n        login = \"techuser_2fa\"\n        password = \"Test123!\"\n        email = fake.email()\n        num = \"89261930112\"\n        user_id, token = await create_test_user(login, password, email, num)\n        try:\n             async with AsyncClient(transport=ASGITransport(app=app), base_url=\"http://localhost:8000\") as client:\n>               resp_login = await client.post(\"/api/login1\", json={\"login\": login, \"password\": password})\n                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\ntests/e2e/test_authentication_e2e.py:55: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n../../../.cache/pypoetry/virtualenvs/ppo-_4RQizgT-py3.13/lib/python3.13/site-packages/httpx/_client.py:1905: in post\n    return await self.request(\n../../../.cache/pypoetry/virtualenvs/ppo-_4RQizgT-py3.13/lib/python3.13/site-packages/httpx/_client.py:1585: in request\n    return await self.send(request, auth=auth, follow_redirects=follow_redirects)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n../../../.cache/pypoetry/virtualenvs/ppo-_4RQizgT-py3.13/lib/python3.13/site-packages/httpx/_client.py:1674: in send\n    response = await self._send_handling_auth(\n../../../.cache/pypoetry/virtualenvs/ppo-_4RQizgT-py3.13/lib/python3.13/site-packages/httpx/_client.py:1702: in _send_handling_auth\n    response = await self._send_handling_redirects(\n../../../.cache/pypoetry/virtualenvs/ppo-_4RQizgT-py3.13/lib/python3.13/site-packages/httpx/_client.py:1739: in _send_handling_redirects\n    response = await self._send_single_request(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n../../../.cache/pypoetry/virtualenvs/ppo-_4RQizgT-py3.13/lib/python3.13/site-packages/httpx/_client.py:1776: in _send_single_request\n    response = await transport.handle_async_request(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n../../../.cache/pypoetry/virtualenvs/ppo-_4RQizgT-py3.13/lib/python3.13/site-packages/httpx/_transports/asgi.py:157: in handle_async_request\n    await self.app(scope, receive, send)\n../../../.cache/pypoetry/virtualenvs/ppo-_4RQizgT-py3.13/lib/python3.13/site-packages/fastapi/applications.py:1054: in __call__\n    await super().__call__(scope, receive, send)\n../../../.cache/pypoetry/virtualenvs/ppo-_4RQizgT-py3.13/lib/python3.13/site-packages/starlette/applications.py:112: in __call__\n    await self.middleware_stack(scope, receive, send)\n../../../.cache/pypoetry/virtualenvs/ppo-_4RQizgT-py3.13/lib/python3.13/site-packages/starlette/middleware/errors.py:187: in __call__\n    raise exc\n../../../.cache/pypoetry/virtualenvs/ppo-_4RQizgT-py3.13/lib/python3.13/site-packages/starlette/middleware/errors.py:165: in __call__\n    await self.app(scope, receive, _send)\n../../../.cache/pypoetry/virtualenvs/ppo-_4RQizgT-py3.13/lib/python3.13/site-packages/starlette/middleware/exceptions.py:62: in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n../../../.cache/pypoetry/virtualenvs/ppo-_4RQizgT-py3.13/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app\n    raise exc\n../../../.cache/pypoetry/virtualenvs/ppo-_4RQizgT-py3.13/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app\n    await app(scope, receive, sender)\n../../../.cache/pypoetry/virtualenvs/ppo-_4RQizgT-py3.13/lib/python3.13/site-packages/starlette/routing.py:714: in __call__\n    await self.middleware_stack(scope, receive, send)\n../../../.cache/pypoetry/virtualenvs/ppo-_4RQizgT-py3.13/lib/python3.13/site-packages/starlette/routing.py:734: in app\n    await route.handle(scope, receive, send)\n../../../.cache/pypoetry/virtualenvs/ppo-_4RQizgT-py3.13/lib/python3.13/site-packages/starlette/routing.py:288: in handle\n    await self.app(scope, receive, send)\n../../../.cache/pypoetry/virtualenvs/ppo-_4RQizgT-py3.13/lib/python3.13/site-packages/starlette/routing.py:76: in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n../../../.cache/pypoetry/virtualenvs/ppo-_4RQizgT-py3.13/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app\n    raise exc\n../../../.cache/pypoetry/virtualenvs/ppo-_4RQizgT-py3.13/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app\n    await app(scope, receive, sender)\n../../../.cache/pypoetry/virtualenvs/ppo-_4RQizgT-py3.13/lib/python3.13/site-packages/starlette/routing.py:73: in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n../../../.cache/pypoetry/virtualenvs/ppo-_4RQizgT-py3.13/lib/python3.13/site-packages/fastapi/routing.py:301: in app\n    raw_response = await run_endpoint_function(\n../../../.cache/pypoetry/virtualenvs/ppo-_4RQizgT-py3.13/lib/python3.13/site-packages/fastapi/routing.py:212: in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nsrc/routers/user.py:98: in login1_user\n    await send_email(user.email, \"Ваш 2FA код\", f\"Ваш код: {code}\")\nsrc/routers/user.py:41: in send_email\n    await aiosmtplib.send(\n../../../.cache/pypoetry/virtualenvs/ppo-_4RQizgT-py3.13/lib/python3.13/site-packages/aiosmtplib/api.py:124: in send\n    async with client:\n               ^^^^^^\n../../../.cache/pypoetry/virtualenvs/ppo-_4RQizgT-py3.13/lib/python3.13/site-packages/aiosmtplib/smtp.py:178: in __aenter__\n    await self.connect()\n../../../.cache/pypoetry/virtualenvs/ppo-_4RQizgT-py3.13/lib/python3.13/site-packages/aiosmtplib/smtp.py:453: in connect\n    raise exc\n../../../.cache/pypoetry/virtualenvs/ppo-_4RQizgT-py3.13/lib/python3.13/site-packages/aiosmtplib/smtp.py:446: in connect\n    response = await self._create_connection(\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <aiosmtplib.smtp.SMTP object at 0x7f1d0491a7b0>, timeout = 60\n\n    async def _create_connection(self, timeout: Optional[float]) -> SMTPResponse:\n        if self.loop is None:\n            raise RuntimeError(\"No event loop set\")\n    \n        protocol = SMTPProtocol(loop=self.loop, connection_lost_callback=self.close)\n    \n        tls_context: Optional[ssl.SSLContext] = None\n        ssl_handshake_timeout: Optional[float] = None\n        server_hostname: Optional[str] = None\n        if self.use_tls:\n            tls_context = self._get_tls_context()\n            ssl_handshake_timeout = timeout\n            server_hostname = self.hostname\n    \n        if self.sock is not None:\n            connect_coro = self.loop.create_connection(\n                lambda: protocol,\n                sock=self.sock,\n                ssl=tls_context,\n                server_hostname=server_hostname,\n                ssl_handshake_timeout=ssl_handshake_timeout,\n            )\n        elif self.socket_path is not None:\n            connect_coro = self.loop.create_unix_connection(\n                lambda: protocol,\n                path=self.socket_path,  # type: ignore\n                ssl=tls_context,\n                server_hostname=server_hostname,\n                ssl_handshake_timeout=ssl_handshake_timeout,\n            )\n        else:\n            if self.hostname is None:\n                raise RuntimeError(\"No hostname provided; default should have been set\")\n            if self.port is None:\n                raise RuntimeError(\"No port provided; default should have been set\")\n    \n            connect_coro = self.loop.create_connection(\n                lambda: protocol,\n                host=self.hostname,\n                port=self.port,\n                ssl=tls_context,\n                ssl_handshake_timeout=ssl_handshake_timeout,\n                local_addr=self.source_address,\n            )\n    \n        try:\n            transport, _ = await asyncio.wait_for(connect_coro, timeout=timeout)\n        except (TimeoutError, asyncio.TimeoutError) as exc:\n            raise SMTPConnectTimeoutError(\n                f\"Timed out connecting to {self.hostname} on port {self.port}\"\n            ) from exc\n        except OSError as exc:\n>           raise SMTPConnectError(\n                f\"Error connecting to {self.hostname} on port {self.port}: {exc}\"\n            ) from exc\nE           aiosmtplib.errors.SMTPConnectError: Error connecting to mailhog on port 1025: [Errno -3] Temporary failure in name resolution\n\n../../../.cache/pypoetry/virtualenvs/ppo-_4RQizgT-py3.13/lib/python3.13/site-packages/aiosmtplib/smtp.py:509: SMTPConnectError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"_verify_url","time":{"start":1762332343881,"stop":1762332343881,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"base_url","time":{"start":1762332343881,"stop":1762332343881,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"_session_faker","time":{"start":1762332343881,"stop":1762332343946,"duration":65},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"pytestconfig","time":{"start":1762332343946,"stop":1762332343946,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"event_loop","time":{"start":1762332343947,"stop":1762332343948,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"delete_output_dir","time":{"start":1762332343947,"stop":1762332343947,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"event_loop_policy","time":{"start":1762332343947,"stop":1762332343947,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"testStage":{"status":"broken","statusMessage":"aiosmtplib.errors.SMTPConnectError: Error connecting to mailhog on port 1025: [Errno -3] Temporary failure in name resolution","statusTrace":"self = <aiosmtplib.smtp.SMTP object at 0x7f1d0491a7b0>, timeout = 60\n\n    async def _create_connection(self, timeout: Optional[float]) -> SMTPResponse:\n        if self.loop is None:\n            raise RuntimeError(\"No event loop set\")\n    \n        protocol = SMTPProtocol(loop=self.loop, connection_lost_callback=self.close)\n    \n        tls_context: Optional[ssl.SSLContext] = None\n        ssl_handshake_timeout: Optional[float] = None\n        server_hostname: Optional[str] = None\n        if self.use_tls:\n            tls_context = self._get_tls_context()\n            ssl_handshake_timeout = timeout\n            server_hostname = self.hostname\n    \n        if self.sock is not None:\n            connect_coro = self.loop.create_connection(\n                lambda: protocol,\n                sock=self.sock,\n                ssl=tls_context,\n                server_hostname=server_hostname,\n                ssl_handshake_timeout=ssl_handshake_timeout,\n            )\n        elif self.socket_path is not None:\n            connect_coro = self.loop.create_unix_connection(\n                lambda: protocol,\n                path=self.socket_path,  # type: ignore\n                ssl=tls_context,\n                server_hostname=server_hostname,\n                ssl_handshake_timeout=ssl_handshake_timeout,\n            )\n        else:\n            if self.hostname is None:\n                raise RuntimeError(\"No hostname provided; default should have been set\")\n            if self.port is None:\n                raise RuntimeError(\"No port provided; default should have been set\")\n    \n            connect_coro = self.loop.create_connection(\n                lambda: protocol,\n                host=self.hostname,\n                port=self.port,\n                ssl=tls_context,\n                ssl_handshake_timeout=ssl_handshake_timeout,\n                local_addr=self.source_address,\n            )\n    \n        try:\n>           transport, _ = await asyncio.wait_for(connect_coro, timeout=timeout)\n                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\n../../../.cache/pypoetry/virtualenvs/ppo-_4RQizgT-py3.13/lib/python3.13/site-packages/aiosmtplib/smtp.py:503: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/opt/hostedtoolcache/Python/3.13.9/x64/lib/python3.13/asyncio/tasks.py:507: in wait_for\n    return await fut\n           ^^^^^^^^^\n/opt/hostedtoolcache/Python/3.13.9/x64/lib/python3.13/asyncio/base_events.py:1122: in create_connection\n    infos = await self._ensure_resolved(\n/opt/hostedtoolcache/Python/3.13.9/x64/lib/python3.13/asyncio/base_events.py:1508: in _ensure_resolved\n    return await loop.getaddrinfo(host, port, family=family, type=type,\n/opt/hostedtoolcache/Python/3.13.9/x64/lib/python3.13/asyncio/base_events.py:939: in getaddrinfo\n    return await self.run_in_executor(\n/opt/hostedtoolcache/Python/3.13.9/x64/lib/python3.13/concurrent/futures/thread.py:59: in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nhost = 'mailhog', port = 1025, family = 0, type = <SocketKind.SOCK_STREAM: 1>\nproto = 0, flags = 0\n\n    def getaddrinfo(host, port, family=0, type=0, proto=0, flags=0):\n        \"\"\"Resolve host and port into list of address info entries.\n    \n        Translate the host/port argument into a sequence of 5-tuples that contain\n        all the necessary arguments for creating a socket connected to that service.\n        host is a domain name, a string representation of an IPv4/v6 address or\n        None. port is a string service name such as 'http', a numeric port number or\n        None. By passing None as the value of host and port, you can pass NULL to\n        the underlying C API.\n    \n        The family, type and proto arguments can be optionally specified in order to\n        narrow the list of addresses returned. Passing zero as a value for each of\n        these arguments selects the full range of results.\n        \"\"\"\n        # We override this function since we want to translate the numeric family\n        # and socket type values to enum constants.\n        addrlist = []\n>       for res in _socket.getaddrinfo(host, port, family, type, proto, flags):\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nE       socket.gaierror: [Errno -3] Temporary failure in name resolution\n\n/opt/hostedtoolcache/Python/3.13.9/x64/lib/python3.13/socket.py:977: gaierror\n\nThe above exception was the direct cause of the following exception:\n\n    @pytest.mark.order(1)\n    @pytest.mark.asyncio\n    async def test_2fa_email():\n        login = \"techuser_2fa\"\n        password = \"Test123!\"\n        email = fake.email()\n        num = \"89261930112\"\n        user_id, token = await create_test_user(login, password, email, num)\n        try:\n             async with AsyncClient(transport=ASGITransport(app=app), base_url=\"http://localhost:8000\") as client:\n>               resp_login = await client.post(\"/api/login1\", json={\"login\": login, \"password\": password})\n                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\ntests/e2e/test_authentication_e2e.py:55: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n../../../.cache/pypoetry/virtualenvs/ppo-_4RQizgT-py3.13/lib/python3.13/site-packages/httpx/_client.py:1905: in post\n    return await self.request(\n../../../.cache/pypoetry/virtualenvs/ppo-_4RQizgT-py3.13/lib/python3.13/site-packages/httpx/_client.py:1585: in request\n    return await self.send(request, auth=auth, follow_redirects=follow_redirects)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n../../../.cache/pypoetry/virtualenvs/ppo-_4RQizgT-py3.13/lib/python3.13/site-packages/httpx/_client.py:1674: in send\n    response = await self._send_handling_auth(\n../../../.cache/pypoetry/virtualenvs/ppo-_4RQizgT-py3.13/lib/python3.13/site-packages/httpx/_client.py:1702: in _send_handling_auth\n    response = await self._send_handling_redirects(\n../../../.cache/pypoetry/virtualenvs/ppo-_4RQizgT-py3.13/lib/python3.13/site-packages/httpx/_client.py:1739: in _send_handling_redirects\n    response = await self._send_single_request(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n../../../.cache/pypoetry/virtualenvs/ppo-_4RQizgT-py3.13/lib/python3.13/site-packages/httpx/_client.py:1776: in _send_single_request\n    response = await transport.handle_async_request(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n../../../.cache/pypoetry/virtualenvs/ppo-_4RQizgT-py3.13/lib/python3.13/site-packages/httpx/_transports/asgi.py:157: in handle_async_request\n    await self.app(scope, receive, send)\n../../../.cache/pypoetry/virtualenvs/ppo-_4RQizgT-py3.13/lib/python3.13/site-packages/fastapi/applications.py:1054: in __call__\n    await super().__call__(scope, receive, send)\n../../../.cache/pypoetry/virtualenvs/ppo-_4RQizgT-py3.13/lib/python3.13/site-packages/starlette/applications.py:112: in __call__\n    await self.middleware_stack(scope, receive, send)\n../../../.cache/pypoetry/virtualenvs/ppo-_4RQizgT-py3.13/lib/python3.13/site-packages/starlette/middleware/errors.py:187: in __call__\n    raise exc\n../../../.cache/pypoetry/virtualenvs/ppo-_4RQizgT-py3.13/lib/python3.13/site-packages/starlette/middleware/errors.py:165: in __call__\n    await self.app(scope, receive, _send)\n../../../.cache/pypoetry/virtualenvs/ppo-_4RQizgT-py3.13/lib/python3.13/site-packages/starlette/middleware/exceptions.py:62: in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n../../../.cache/pypoetry/virtualenvs/ppo-_4RQizgT-py3.13/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app\n    raise exc\n../../../.cache/pypoetry/virtualenvs/ppo-_4RQizgT-py3.13/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app\n    await app(scope, receive, sender)\n../../../.cache/pypoetry/virtualenvs/ppo-_4RQizgT-py3.13/lib/python3.13/site-packages/starlette/routing.py:714: in __call__\n    await self.middleware_stack(scope, receive, send)\n../../../.cache/pypoetry/virtualenvs/ppo-_4RQizgT-py3.13/lib/python3.13/site-packages/starlette/routing.py:734: in app\n    await route.handle(scope, receive, send)\n../../../.cache/pypoetry/virtualenvs/ppo-_4RQizgT-py3.13/lib/python3.13/site-packages/starlette/routing.py:288: in handle\n    await self.app(scope, receive, send)\n../../../.cache/pypoetry/virtualenvs/ppo-_4RQizgT-py3.13/lib/python3.13/site-packages/starlette/routing.py:76: in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n../../../.cache/pypoetry/virtualenvs/ppo-_4RQizgT-py3.13/lib/python3.13/site-packages/starlette/_exception_handler.py:53: in wrapped_app\n    raise exc\n../../../.cache/pypoetry/virtualenvs/ppo-_4RQizgT-py3.13/lib/python3.13/site-packages/starlette/_exception_handler.py:42: in wrapped_app\n    await app(scope, receive, sender)\n../../../.cache/pypoetry/virtualenvs/ppo-_4RQizgT-py3.13/lib/python3.13/site-packages/starlette/routing.py:73: in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n../../../.cache/pypoetry/virtualenvs/ppo-_4RQizgT-py3.13/lib/python3.13/site-packages/fastapi/routing.py:301: in app\n    raw_response = await run_endpoint_function(\n../../../.cache/pypoetry/virtualenvs/ppo-_4RQizgT-py3.13/lib/python3.13/site-packages/fastapi/routing.py:212: in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nsrc/routers/user.py:98: in login1_user\n    await send_email(user.email, \"Ваш 2FA код\", f\"Ваш код: {code}\")\nsrc/routers/user.py:41: in send_email\n    await aiosmtplib.send(\n../../../.cache/pypoetry/virtualenvs/ppo-_4RQizgT-py3.13/lib/python3.13/site-packages/aiosmtplib/api.py:124: in send\n    async with client:\n               ^^^^^^\n../../../.cache/pypoetry/virtualenvs/ppo-_4RQizgT-py3.13/lib/python3.13/site-packages/aiosmtplib/smtp.py:178: in __aenter__\n    await self.connect()\n../../../.cache/pypoetry/virtualenvs/ppo-_4RQizgT-py3.13/lib/python3.13/site-packages/aiosmtplib/smtp.py:453: in connect\n    raise exc\n../../../.cache/pypoetry/virtualenvs/ppo-_4RQizgT-py3.13/lib/python3.13/site-packages/aiosmtplib/smtp.py:446: in connect\n    response = await self._create_connection(\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <aiosmtplib.smtp.SMTP object at 0x7f1d0491a7b0>, timeout = 60\n\n    async def _create_connection(self, timeout: Optional[float]) -> SMTPResponse:\n        if self.loop is None:\n            raise RuntimeError(\"No event loop set\")\n    \n        protocol = SMTPProtocol(loop=self.loop, connection_lost_callback=self.close)\n    \n        tls_context: Optional[ssl.SSLContext] = None\n        ssl_handshake_timeout: Optional[float] = None\n        server_hostname: Optional[str] = None\n        if self.use_tls:\n            tls_context = self._get_tls_context()\n            ssl_handshake_timeout = timeout\n            server_hostname = self.hostname\n    \n        if self.sock is not None:\n            connect_coro = self.loop.create_connection(\n                lambda: protocol,\n                sock=self.sock,\n                ssl=tls_context,\n                server_hostname=server_hostname,\n                ssl_handshake_timeout=ssl_handshake_timeout,\n            )\n        elif self.socket_path is not None:\n            connect_coro = self.loop.create_unix_connection(\n                lambda: protocol,\n                path=self.socket_path,  # type: ignore\n                ssl=tls_context,\n                server_hostname=server_hostname,\n                ssl_handshake_timeout=ssl_handshake_timeout,\n            )\n        else:\n            if self.hostname is None:\n                raise RuntimeError(\"No hostname provided; default should have been set\")\n            if self.port is None:\n                raise RuntimeError(\"No port provided; default should have been set\")\n    \n            connect_coro = self.loop.create_connection(\n                lambda: protocol,\n                host=self.hostname,\n                port=self.port,\n                ssl=tls_context,\n                ssl_handshake_timeout=ssl_handshake_timeout,\n                local_addr=self.source_address,\n            )\n    \n        try:\n            transport, _ = await asyncio.wait_for(connect_coro, timeout=timeout)\n        except (TimeoutError, asyncio.TimeoutError) as exc:\n            raise SMTPConnectTimeoutError(\n                f\"Timed out connecting to {self.hostname} on port {self.port}\"\n            ) from exc\n        except OSError as exc:\n>           raise SMTPConnectError(\n                f\"Error connecting to {self.hostname} on port {self.port}: {exc}\"\n            ) from exc\nE           aiosmtplib.errors.SMTPConnectError: Error connecting to mailhog on port 1025: [Errno -3] Temporary failure in name resolution\n\n../../../.cache/pypoetry/virtualenvs/ppo-_4RQizgT-py3.13/lib/python3.13/site-packages/aiosmtplib/smtp.py:509: SMTPConnectError","steps":[],"attachments":[{"name":"log","type":"text/plain","size":0},{"name":"stdout","type":"text/plain","size":0}],"parameters":[],"shouldDisplayMessage":true,"stepsCount":0,"attachmentsCount":2,"hasContent":true,"attachmentStep":false},"afterStages":[{"name":"event_loop::finalizer","time":{"start":1762332349618,"stop":1762332349618,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"event_loop::_close_event_loop","time":{"start":1762332349618,"stop":1762332349618,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"event_loop::_restore_policy","time":{"start":1762332349618,"stop":1762332349618,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"event_loop::_provide_clean_event_loop","time":{"start":1762332349618,"stop":1762332349619,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"labels":[{"name":"tag","value":"asyncio"},{"name":"parentSuite","value":"tests.e2e"},{"name":"suite","value":"test_authentication_e2e"},{"name":"host","value":"runnervmf2e7y"},{"name":"thread","value":"2794-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.e2e.test_authentication_e2e"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Test defects","matchedStatuses":[],"flaky":false}],"history":{"statistic":{"failed":0,"broken":2,"skipped":0,"passed":0,"unknown":0,"total":2},"items":[{"uid":"8c923d918babc114","status":"broken","statusDetails":"aiosmtplib.errors.SMTPConnectError: Error connecting to mailhog on port 1025: [Errno -3] Temporary failure in name resolution","time":{"start":1762331741561,"stop":1762331742247,"duration":686}}]},"tags":["asyncio"]},"source":"815b51f4cdf5a944.json","parameterValues":[]}